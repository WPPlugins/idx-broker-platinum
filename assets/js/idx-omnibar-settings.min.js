window.addEventListener("DOMContentLoaded",function(){function e(e,t,n){for(var i=0;i<e.length;i++)t.call(n,e[i],i)}function t(){jQuery(".select2").select2({maximumSelectionLength:10,placeholder:"Select Up to Ten Fields"})}function n(){"undefined"!=typeof p&&p.addEventListener("click",function(e){e.preventDefault(),jQuery(".status").fadeIn("fast").html(v+"Saving Settings..."),d(),y()})}function i(){e(m,function(e){e.addEventListener("change",l)})}function o(){jQuery(g).on("change",c)}function l(){return e(m,function(e){var t=e.name,n=e.value;"basic"!==t&&r(t,n)}),c()}function r(t,n){var i=g.querySelectorAll("."+t)[0],o=i.querySelectorAll("option");return e(o,function(e){e.getAttribute("data-mlsptid")!==n?e.disabled=!0:e.disabled=!1,"listingAgentID"!=e.getAttribute("value")&&"listingOfficeID"!=e.getAttribute("value")&&"coListingAgentID"!=e.getAttribute("value")&&"coListingOfficeID"!=e.getAttribute("value")&&"tertiaryListingAgentID"!=e.getAttribute("value")&&"tertiaryListingOfficeID"!=e.getAttribute("value")||(e.disabled=!0)}),a(g)}function a(e){return jQuery(e).select2("destroy"),jQuery(e).select2()}function c(){u();var t=g.selectedOptions;e(t,function(e){try{if(e.disabled===!0)throw e}catch(t){s(t.title)}})}function u(){document.querySelectorAll(".select2-container--default")[0].classList.remove("warning"),b.style.display="none",b.querySelector("p").innerHTML=""}function s(e){var t=e+" is not in the selected property type. Please choose a Custom Field within the selected MLS Specific Property Type.<br>";b.querySelector("p").insertAdjacentHTML("beforeend",t),b.style.display="block",document.querySelectorAll(".select2-container--default")[0].classList.add("warning")}function d(){if("undefined"!=typeof document.querySelectorAll(".city-list")[0]){var e=jQuery(".city-list select").val(),t=jQuery(".county-list select").val(),n=jQuery(".zipcode-list select").val();jQuery.post(ajaxurl,{action:"idx_update_omnibar_current_ccz","city-list":e,"county-list":t,"zipcode-list":n},function(){f()})}}function f(){if(void 0!==g.options){for(var e=[],t=0;t<g.options.length;t++)if(g.options[t].selected){var n=g.options[t].parentNode.classList[0],i=g.options[t].value,o=g.options[t].label,l=g.options[t].getAttribute("data-mlsptid"),r={idxID:n,value:i,mlsPtID:l,name:o};e.push(r)}for(var a=[],t=0;t<m.length;t++){var n=m[t].name,i=m[t].value,c={idxID:n,mlsPtID:i};a.push(c)}var u=document.querySelectorAll(".omnibar-placeholder")[0].value;jQuery.post(ajaxurl,{action:"idx_update_omnibar_custom_fields",fields:e,mlsPtIDs:a,placeholder:u},function(){window.location.reload()})}}function y(){var e=document.getElementById("sort-order");jQuery.post(ajaxurl,{action:"idx_update_sort_order","sort-order":e.options[e.selectedIndex].value},function(){window.location.reload()})}"undefined"!=typeof loadOmnibarView&&jQuery.post(ajaxurl,{action:"idx_preload_omnibar_settings_view"},function(){window.location.reload()});var p=document.querySelectorAll("#save_changes")[0],v="<span class='ajax'></span>",m=document.querySelectorAll(".omnibar-mlsPtID"),g=(document.querySelectorAll(".sort-order"),document.querySelectorAll(".omnibar-additional-custom-field")[0]),b=document.querySelectorAll(".customFieldError")[0];!function(){t(),n(),l(),i(),o()}()});